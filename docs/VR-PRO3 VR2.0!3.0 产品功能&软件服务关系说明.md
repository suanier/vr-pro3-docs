# 背景

| 产品名称（对外） | Visbody-R ProX | Visbody-R Pro3 | Visbody-R Pro3 | Visbody-R Pro3 |
| ---------------- | -------------- | -------------- | -------------- | -------------- |
| 项目名称（对内） | VR 3.0         | VR 2.0         | VR-PRO3        | VR-PRO3 1.0    |
| 项目背景         |

1. 方便海外运输
2. 方便零部件拆卸
3. 增高整体稳定性
   |
4. 解决三相机掉线及对不齐问题
5. 降成本
   | | 客户购买 VR 的设备可单独购买转台升级为 VR-PRO3 |
   | ID 差异 | 与 VR 2.0 保存一致 | 取消三个相机孔位改为单相机 | 增加转台 | |
   | 功能差异 | 保持一致，后续功能规划也保持一致 | | | |
   | 设备端软件差异 |
6. 设备端上的服务通信改为 gRPC
7. 精简控制服务，将原来纯转发功能移除
8. 客户端功能进行模块化设计为后续兼容其他产品
9. 客户端直接使用 i18n 多国语言通用版
   | 算法服务（手势、扫描）改为单相机版本，其他服务不变 | | |
   | 云端软件差异 |
10. 与 VR-PRO3 云端通用
11. 将 prox 的 web 端域名解析到 pro3 上
    | 云端通用 | | |

# 设备端软件服务

## VR-PRO3 & VR-PRO3 1.0

### 说明

控制服务作为中转中心，承担客户端与硬件服务、扫描服务、手势服务之间的通信，同时兼具与云端服务通信的能力，将测量生成的模型、电阻等文件发送到云端，由云端服务发起算法合成。

所有服务通过 socket 通信，使用 proto2 文件，约定双方通信协议格式进行通信。

### 问题

控制服务作为中转中心，里面有很多纯转发的功能，即控制服务直接将请求转发给其他服务，这样会增加通信的复杂度，增加无谓的工作

私有协议维护起来困难，随着人员更替，版本迭代，维护人员往往不能很清晰的梳理出一条链路，维护变得愈发困难。

![](https://cdn.nlark.com/yuque/0/2022/jpeg/12670649/1653365285147-9f6d39c5-b9d3-4d3f-9201-20e42cfb4ffd.jpeg)

## VR 2.0

![](https://cdn.nlark.com/yuque/0/2022/jpeg/12670649/1653365287177-3a9f3654-a9e1-4935-940e-50066c47ca63.jpeg)

## VR 3.0

### 说明

精简控制服务作为纯转发的功能，由通信双方直接通信。控制服务兼容与云端服务通信的方式，同时支持 gRPC 和 socket 私有协议的方式。

弃用私有协议，socket 通信方式，改为使用范围更广，成熟度更高的 gRPC 通信方式。

更新服务也改为使用 gRPC 通信。

![](https://cdn.nlark.com/yuque/0/2022/jpeg/12670649/1653365289337-986d907d-c2ab-4373-8f8e-8c16626adee3.jpeg)

# 后台

任务模型任务上传优化，网络不好时会导致失败任务一直卡住（2022-02-17）

# 影响

2022-02-07

1. 客户端国内外开发通用版，加长了 vr3.0 的整体开发时间

2. vr3.0 上线后，在没有兼容 vr2.0 、pro3 期间，会出现同一功能在不同架构下重复开发的问题，延长了功能开发时间
